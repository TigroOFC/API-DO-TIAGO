<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>API do Tiago</title>
<style>
  body { font-family: Arial; background:#1e1e1e; color:#fff; display:flex; flex-direction:column; align-items:center; justify-content:center; height:100vh; }
  input, textarea { padding:10px; margin:5px; width:400px; border-radius:5px; border:none; }
  button { padding:10px 20px; margin:10px; border:none; background:#007acc; color:white; border-radius:5px; cursor:pointer; }
  #reply { margin-top:20px; white-space:pre-wrap; }
</style>
</head>
<body>

<h1>API do Tiago</h1>
<button id="generateKey">Gerar Chave API</button>
<input type="text" id="apiKey" placeholder="Sua chave aparecerÃ¡ aqui" readonly />
<textarea id="message" placeholder="Digite sua mensagem"></textarea>
<button id="sendMessage">Enviar Mensagem</button>
<div id="reply"></div>

<script>
document.getElementById("generateKey").addEventListener("click", async () => {
  const res = await fetch("/api/generate-key");
  const data = await res.json();
  document.getElementById("apiKey").value = data.key;
});

document.getElementById("sendMessage").addEventListener("click", async () => {
  const key = document.getElementById("apiKey").value;
  const message = document.getElementById("message").value;
  if(!key) return alert("Gere uma chave primeiro!");
  if(!message) return alert("Digite uma mensagem!");

  const res = await fetch("/api/tiago", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "x-api-key": key
    },
    body: JSON.stringify({ message })
  });
  const data = await res.json();
  document.getElementById("reply").innerText = data.reply || data.error;
});
</script>

</body>
</html>
